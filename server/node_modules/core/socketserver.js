let WebSocket = require('ws');
let User = require('core/user');

class SocketServer {
	constructor() {
		this.setOptions({ port : 8080, compression : { enabled : true } });
	};

	setOptions(options) {
		this._options = Object.assign(this._options || {}, options);
	};

	getOptions() {
		return this._options;
	};

	run() {
		let options = this.getOptions();

		let server = new WebSocket.Server({
			port : 8080
		});

		server.on('connection', (socket) => {
			User.addUser(socket);
		});
	};

	static getInstance() {
		if(this._instance === null) {
			this._instance = new SocketServer();
		}

		return this._instance;
	};
};

SocketServer._instance = null;

module.exports = SocketServer;